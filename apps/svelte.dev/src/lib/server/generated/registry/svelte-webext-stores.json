{
	"name": "svelte-webext-stores",
	"description": "Synchronize Svelte stores with WebExtension storage.",
	"repo_url": "https://github.com/ChrRubin/svelte-webext-stores",
	"authors": ["chrrubin"],
	"homepage": "https://github.com/ChrRubin/svelte-webext-stores",
	"downloads": 21,
	"updated": "2022-10-14T13:06:33.667Z",
	"tags": ["miscellaneous"],
	"github_stars": 6,
	"typescript": true,
	"version": "0.0.13",
	"svelte_range": "^3.0.0",
	"last_rune_check_version": "0.0.13",
	"dependency_tree": {
		"rootIndex": 0,
		"packages": [
			{
				"name": "svelte-webext-stores",
				"version": "0.0.13",
				"size": 66616
			}
		],
		"dependencies": [],
		"circular": []
	},
	"readme": "# svelte-webext-stores\n\nSvelte stores that are synchronized with extension storage.\n\nNote: *This library is currently in alpha development, and is subject to breaking changes with or without warning.*\n\n## Features\n\n- **Different storage types support:** `chrome.storage` (either MV2 or MV3), `browser.storage` (including [webextension-polyfill](https://github.com/mozilla/webextension-polyfill)), and even non-extension storage such as `window.localStorage` and `window.sessionStorage` are supported out of the box.\n- **Automatically synchronizes** to and from storage backend.\n- **TypeScript support:** This library is fully written in TypeScript, and the distributed package includes TypeScript declarations.\n- **Custom implementations:** Create and use your own custom storage backends or synchronized stores by implementing `IStorageBackend` or `ISyncStore` respectively.\n\n## Getting started\n\n### Installation\n\n`npm install -D svelte-webext-stores`\n\nor\n\n`yarn add -D svelte-webext-stores`\n\n### Quick Usage\n\n`storage.js`\n\n```javascript\nimport { webExtStores } from 'svelte-webext-stores';\n\n// Instantiate default store handler, which is backed by MV2 chrome.storage.local\nconst stores = webExtStores();\n// Register a new synchronized store with storage key 'count' and default value of 1\nexport const count = stores.addSyncStore('count', 1);\n```\n\n`App.svelte`\n\n```html\n<script>\n  import { count } from './storage.js';\n\n  function addCount() {\n    $count += 1;\n  }\n</script>\n\n<button on:click={addCount}>Count: {$count}</button>\n```\n\n## Advanced Usage\n\n## Storage Backends\n\nThis library supports and exports the following storage options out of the box. To use a provided storage option, simply import it and pass it into `webExtStores`.\n\n| Storage | Description |\n| --- | --- |\n| `storageMV2` | Chrome Manifest Version 2 (callback API). |\n| `storageMV3` | Chrome Manifest Version 3 (Promise API). |\n| `storageWebExt` | Mozilla WebExtension (browser API), including [webextension-polyfill](https://github.com/mozilla/webextension-polyfill). |\n| `storageLegacy` | Legacy/non-extension storage (`localStorage` or `sessionStorage`). |\n\nTo set the storage area/type, pass the corresponding string parameter.\n\n| Storage | Allowed parameter | Default\n| --- | --- | --- |\n| `storageMV2`, `storageMV3`, `storageWebExt` | `'local'` \\| `'sync'` \\| `'managed'` | `'local'` |\n| `storageLegacy` | `'session'` \\| `'local'` | `'session'`\n\nExample:\n\n```js\nimport { webExtStores, storageWebExt } from 'svelte-webext-stores';\n\n// Uses the Mozilla WebExtension browser API in the 'sync' area.\nconst stores = webExtStores(storageWebExt('sync'));\n```\n\nMore information on the `IStorageBackend` interface that is implemented by all the above storage backends can be found [here](INTERFACES.md#istoragebackend).\n\n## Synchronized Stores\n\nAll provided synchronized stores below implements the `ISyncStore` interface. More information can be found [here](INTERFACES.md#isyncstore).\n\n### `SyncStore`\n\nStandard store that synchronizes to the storage backend. Uses Svelte `writable` to implement the Svelte store contract.\n\n```ts\nWebExtStores.addSyncStore<T>(\n  key: string,\n  defaultValue: T,\n  syncFromExternal = true,\n  versionedOptions?: VersionedOptions\n): SyncStore<T>\n```\n\n| Parameter | Description |\n| --- | --- |\n| key | Storage key |\n| defaultValue | Store's default value |\n| syncFromExternal | Whether store should be updated when storage value is updated externally |\n| versionedOptions | Enables options for migrating storage values from an older version to a newer version |\n\nAside from methods derived from `ISyncStore`, `SyncStore` also contains the following methods:\n\n| Methods | Signature | Description |\n| --- | --- | --- |\n| ready | `ready: () => Promise<void>` | Ensure that any async initialization process (such as initial update from backend) has been completed. You typically don't need to manually call this unless you wish to sync the store to the storage backend before any of `get()`, `set()`, `subscribe()` or `update()` is called. |\n| reset | `reset: () => Promise<void>` | Reset store value to default value. |\n| update | `update: (updater: (value: T) => T) => Promise<void>` | Update value using callback and inform subscribers. |\n\n### `LookupStore`\n\nSynchronized store for `Record<string, any>` objects. `LookupStore` is derived from and is functionally similar to `SyncStore`, with additional convenience methods for getting and setting the stored object's property values using property keys.\n\n```ts\nWebExtStores.addLookupStore<T extends Record<string, any>>(\n  key: string,\n  defaultValue: T,\n  syncFromExternal = true,\n  versionedOptions?: VersionedOptions<T>\n): LookupStore<T>\n```\n\n| Methods | Signature | Description |\n| --- | --- | --- |\n| getItem | `getItem: <R extends T[keyof T]>(key: keyof T) => Promise<R>` | Get property value. |\n| setItem | `setItem: <V extends T[keyof T]>(key: keyof T, value: V) => Promise<void>` | Set property value. |\n\nExample:\n\n```js\nimport { webExtStores } from 'svelte-webext-stores';\n\nconst stores = webExtStores();\nexport const obj = stores.addLookupStore('obj', { a: 1, b: false, c: '3' });\n\n\nconst a = await obj.getItem('a'); // Returns 1\nawait obj.setItem('b', true); // Object is now { a: 1, b: false, c: '3' }\n```\n\nYou can also easily add these convenience methods to your custom `ISyncStore` implementations. More information can be found [here](INTERFACES.md#ilookupstore).\n\n### Versioned Store Values and Migration\n\n`SyncStore` and its derivatives has the optional parameter `versionedOptions`. When the parameter is provided, it keeps track of the current store's version to enable ease of migrating values from an older store version to the current version. This can be useful to migrate breaking changes on the stored data without reseting its value to default.\n\n`VersionedOptions` properties are as follows:\n\n| Property | Type | Descrption |\n| --- | --- | --- |\n| version | number | Current version number. Do not use `-1`. |\n| seperator | string | Separator between key and version. |\n| migrations | `Map<number, (oldValue: any) => T>` | Map for migrating values. Keys are the old version to match against, and values are callbacks that accepts the value found from the given old version and returns the corresponding value for the current version. Use the key `-1` to migrate from a versionless store. |\n\nSyncStores that are provided with the `versionedOptions` parameter are stored as `${key}${seperator}${version}` internally. When an older version that matches any of the keys in the Map is found, its value is passed to the callback, the returned value is stored and the old version is removed.\n\n```js\n// Initial store\nexport const size = stores.addSyncStore('size', 500);\n\n// Example usage in svelte\nwindow.resizeTo($size, $size);\n```\n\n```js\n// To migrate to a new value, replace the old declaration\nconst sizeMigrations = new Map();\nsizeMigrations.set(-1, (oldValue) => `${oldValue}x${oldValue * 2}`);\n\nexport const size = stores.addSyncStore(\n  'size',\n  '500x1000',\n  true,\n  {\n    version: 1,\n    seperator: '$',\n    migrations: sizeMigrations\n  }\n);\n\n// Example usage in svelte\nconst [width, height] = $size.split('x');\nwindow.resizeTo(width, height);\n```\n",
	"legacy_svelte": false,
	"downloads_history": [
		[3596, 14],
		[3603, 14],
		[3610, 16],
		[3617, 1],
		[3631, 3],
		[3638, 1],
		[3645, 1],
		[3652, 1],
		[3666, 18],
		[3673, 2],
		[3680, 1],
		[3687, 2],
		[3708, 4],
		[3715, 2],
		[3722, 1],
		[3729, 15],
		[3736, 1],
		[3750, 4],
		[3757, 2],
		[3764, 2],
		[3771, 13],
		[3778, 14],
		[3785, 53],
		[3792, 2],
		[3799, 4],
		[3806, 2],
		[3827, 2],
		[3834, 1],
		[3841, 6],
		[3848, 2],
		[3855, 62],
		[3862, 1],
		[3876, 3],
		[3883, 8],
		[3890, 14],
		[3897, 2],
		[3904, 15],
		[3911, 6],
		[3918, 15],
		[3925, 13],
		[3932, 26],
		[3939, 17],
		[3946, 9],
		[3953, 12],
		[3960, 9],
		[3967, 35],
		[3974, 11],
		[3981, 17],
		[3988, 2],
		[3995, 4],
		[4002, 1],
		[4009, 3],
		[4016, 4],
		[4023, 5],
		[4030, 22],
		[4037, 9],
		[4044, 17],
		[4051, 13],
		[4058, 3],
		[4065, 1],
		[4072, 1],
		[4079, 11],
		[4093, 2],
		[4100, 39],
		[4107, 4],
		[4114, 21],
		[4121, 26],
		[4128, 10],
		[4135, 18]
	]
}
